<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Limon Loco M — Dashboard</title>
<script src="https://cdn.jsdelivr.net/npm/chart.js@4.5.1" integrity="sha384-jb8JQMbMoBUzgWatfe6COACi2ljcDdZQ2OxczGA3bGNeWe+6DChMTBJemed7ZnvJ" crossorigin="anonymous"></script>
<style>
:root {
  --bg: #e8ecf1;
  --card: #e8ecf1;
  --shadow-light: rgba(255,255,255,0.7);
  --shadow-dark: rgba(163,177,198,0.6);
  --text-primary: #2d3436;
  --text-secondary: #636e72;
  --text-muted: #b2bec3;
  --accent: #6c5ce7;
  --accent2: #00cec9;
  --accent3: #0984e3;
  --positive: #00b894;
  --negative: #d63031;
  --radius: 16px;
  --gap: 20px;
}
* { margin:0; padding:0; box-sizing:border-box; }
body { font-family: -apple-system, BlinkMacSystemFont, 'SF Pro Display', 'Segoe UI', Roboto, sans-serif; background: var(--bg); color: var(--text-primary); min-height:100vh; }

.dashboard { max-width:1360px; margin:0 auto; padding:32px 24px; }

/* Neumorphic card */
.card {
  background: var(--card);
  border-radius: var(--radius);
  box-shadow: 6px 6px 12px var(--shadow-dark), -6px -6px 12px var(--shadow-light);
  padding: 24px;
  transition: all 0.2s ease;
}

/* Header */
.header { display:flex; justify-content:space-between; align-items:center; margin-bottom:32px; flex-wrap:wrap; gap:16px; }
.header h1 { font-size:26px; font-weight:700; color:var(--text-primary); letter-spacing:-0.5px; }
.header h1 span { color:var(--accent); }
.header-sub { font-size:13px; color:var(--text-secondary); margin-top:2px; }

.filters { display:flex; gap:10px; align-items:center; }
.filter-btn {
  background: var(--card);
  border: none;
  border-radius: 10px;
  padding: 10px 18px;
  font-size: 13px;
  font-weight: 500;
  color: var(--text-secondary);
  cursor: pointer;
  box-shadow: 3px 3px 6px var(--shadow-dark), -3px -3px 6px var(--shadow-light);
  transition: all 0.15s ease;
}
.filter-btn:hover { color: var(--accent); }
.filter-btn.active {
  box-shadow: inset 3px 3px 6px var(--shadow-dark), inset -3px -3px 6px var(--shadow-light);
  color: var(--accent);
  font-weight: 600;
}

/* KPI Row */
.kpis { display:grid; grid-template-columns:repeat(5,1fr); gap:var(--gap); margin-bottom:var(--gap); }
.kpi { text-align:center; }
.kpi .label { font-size:11px; text-transform:uppercase; letter-spacing:1px; color:var(--text-muted); margin-bottom:8px; font-weight:600; }
.kpi .value { font-size:28px; font-weight:700; color:var(--text-primary); }
.kpi .sub { font-size:12px; margin-top:6px; font-weight:500; }
.kpi .sub.up { color:var(--positive); }
.kpi .sub.down { color:var(--negative); }
.kpi .sub.neutral { color:var(--text-muted); }

/* Chart grid */
.grid-2 { display:grid; grid-template-columns:1fr 1fr; gap:var(--gap); margin-bottom:var(--gap); }
.grid-3 { display:grid; grid-template-columns:1fr 1fr 1fr; gap:var(--gap); margin-bottom:var(--gap); }
.full-width { margin-bottom:var(--gap); }

.card h3 {
  font-size:13px; font-weight:600; color:var(--text-secondary);
  text-transform:uppercase; letter-spacing:0.5px; margin-bottom:16px;
}
.chart-wrap { position:relative; width:100%; }
.chart-wrap.h350 { height:320px; }
.chart-wrap.h280 { height:260px; }
.chart-wrap.h220 { height:200px; }

/* Table */
.table-wrap { overflow-x:auto; }
table { width:100%; border-collapse:collapse; font-size:13px; }
th { text-align:left; padding:10px 12px; color:var(--text-muted); font-size:11px; text-transform:uppercase; letter-spacing:0.5px; font-weight:600; border-bottom:2px solid rgba(163,177,198,0.3); }
td { padding:10px 12px; border-bottom:1px solid rgba(163,177,198,0.15); }
tr:hover td { background:rgba(108,92,231,0.04); }
.text-right { text-align:right; }
.yoy-pos { color:var(--positive); font-weight:600; }
.yoy-neg { color:var(--negative); font-weight:600; }

/* Segment badge */
.seg-badge { display:inline-block; padding:3px 10px; border-radius:20px; font-size:11px; font-weight:600; }

footer { text-align:center; color:var(--text-muted); font-size:11px; padding:24px 0 8px; letter-spacing:0.3px; }

@media(max-width:900px) {
  .kpis { grid-template-columns:repeat(2,1fr); }
  .grid-2, .grid-3 { grid-template-columns:1fr; }
}
@media(max-width:600px) {
  .kpis { grid-template-columns:1fr 1fr; }
  .dashboard { padding:16px 12px; }
}
</style>
</head>
<body>
<div class="dashboard">

  <div class="header">
    <div>
      <h1><span>Limon Loco</span> M</h1>
      <div class="header-sub">Business Dashboard  ·  Jan 2024 — Jan 2026</div>
    </div>
    <div class="filters" id="yearFilters"></div>
  </div>

  <div class="kpis" id="kpiRow"></div>

  <div class="full-width card">
    <h3>Revenue Trend</h3>
    <div class="chart-wrap h350"><canvas id="revChart"></canvas></div>
  </div>

  <div class="grid-2">
    <div class="card">
      <h3>Revenue by Category</h3>
      <div class="chart-wrap h280"><canvas id="catChart"></canvas></div>
    </div>
    <div class="card">
      <h3>Client Segments <span style="font-weight:400;text-transform:none;font-size:11px;color:var(--text-muted)">(excl. retail walk-ins)</span></h3>
      <div class="chart-wrap h280"><canvas id="segChart"></canvas></div>
    </div>
  </div>

  <div class="grid-3">
    <div class="card">
      <h3>Day of Week</h3>
      <div class="chart-wrap h220"><canvas id="dowChart"></canvas></div>
    </div>
    <div class="card">
      <h3>Peak Hours</h3>
      <div class="chart-wrap h220"><canvas id="hourChart"></canvas></div>
    </div>
    <div class="card">
      <h3>Weekend vs Weekday</h3>
      <div class="chart-wrap h220"><canvas id="wkdChart"></canvas></div>
    </div>
  </div>

  <div class="grid-2">
    <div class="card">
      <h3>Top 10 Items</h3>
      <div class="table-wrap"><table id="itemsTable"><thead><tr><th>Item</th><th class="text-right">Revenue</th><th class="text-right">Qty</th></tr></thead><tbody></tbody></table></div>
    </div>
    <div class="card">
      <h3>Monthly Detail</h3>
      <div class="table-wrap" style="max-height:400px;overflow-y:auto"><table id="monthTable"><thead><tr><th>Period</th><th class="text-right">Revenue</th><th class="text-right">Checks</th><th class="text-right">YoY</th></tr></thead><tbody></tbody></table></div>
    </div>
  </div>

  <footer>Data from clean_database_M.csv · Client segments exclude RETAIL walk-ins · Generated Feb 2026</footer>
</div>

<script>
const D = {"kpis": {"total_revenue": 872419.59, "total_checks": 41998, "registered_clients": 14480, "avg_check": 16.5, "revenue_2025": 429811.19, "revenue_2024": 405986.53, "yoy_growth": 5.9, "retail_pct": 38.0}, "monthly": [{"year": 2024, "month": 1, "month_year": "2024-01", "revenue": 33405.03, "checks": 2253, "clients": 310, "items": 3524.0, "yoy": null}, {"year": 2024, "month": 2, "month_year": "2024-02", "revenue": 43601.43, "checks": 2654, "clients": 1678, "items": 4415.0, "yoy": null}, {"year": 2024, "month": 3, "month_year": "2024-03", "revenue": 45434.08, "checks": 2886, "clients": 1812, "items": 4630.0, "yoy": null}, {"year": 2024, "month": 4, "month_year": "2024-04", "revenue": 27620.690000000002, "checks": 1761, "clients": 1157, "items": 2650.0, "yoy": null}, {"year": 2024, "month": 5, "month_year": "2024-05", "revenue": 28661.25, "checks": 1647, "clients": 1060, "items": 2586.0, "yoy": null}, {"year": 2024, "month": 6, "month_year": "2024-06", "revenue": 25067.32, "checks": 1617, "clients": 994, "items": 2441.0, "yoy": null}, {"year": 2024, "month": 7, "month_year": "2024-07", "revenue": 30005.59, "checks": 2015, "clients": 1134, "items": 3097.0, "yoy": null}, {"year": 2024, "month": 8, "month_year": "2024-08", "revenue": 38307.33, "checks": 2523, "clients": 1176, "items": 4000.0, "yoy": null}, {"year": 2024, "month": 9, "month_year": "2024-09", "revenue": 35384.13, "checks": 2246, "clients": 931, "items": 3506.0, "yoy": null}, {"year": 2024, "month": 10, "month_year": "2024-10", "revenue": 33205.81, "checks": 1996, "clients": 937, "items": 3142.0, "yoy": null}, {"year": 2024, "month": 11, "month_year": "2024-11", "revenue": 36596.21, "checks": 2067, "clients": 866, "items": 3903.0, "yoy": null}, {"year": 2024, "month": 12, "month_year": "2024-12", "revenue": 28697.66, "checks": 1653, "clients": 778, "items": 2807.0, "yoy": null}, {"year": 2025, "month": 1, "month_year": "2025-01", "revenue": 34070.29, "checks": 1858, "clients": 965, "items": 2973.0, "yoy": 2.0}, {"year": 2025, "month": 2, "month_year": "2025-02", "revenue": 36943.450000000004, "checks": 2220, "clients": 1305, "items": 3748.0, "yoy": -15.3}, {"year": 2025, "month": 3, "month_year": "2025-03", "revenue": 44631.8, "checks": 2603, "clients": 1335, "items": 4429.0, "yoy": -1.8}, {"year": 2025, "month": 4, "month_year": "2025-04", "revenue": 34040.94, "checks": 2041, "clients": 1107, "items": 3584.0, "yoy": 23.2}, {"year": 2025, "month": 5, "month_year": "2025-05", "revenue": 29635.36, "checks": 1696, "clients": 948, "items": 2854.0, "yoy": 3.4}, {"year": 2025, "month": 6, "month_year": "2025-06", "revenue": 25203.8, "checks": 1525, "clients": 747, "items": 2960.0, "yoy": 0.5}, {"year": 2025, "month": 7, "month_year": "2025-07", "revenue": 41868.95, "checks": 2383, "clients": 1123, "items": 5662.0, "yoy": 39.5}, {"year": 2025, "month": 8, "month_year": "2025-08", "revenue": 47507.65, "checks": 3198, "clients": 1736, "items": 6053.0, "yoy": 24.0}, {"year": 2025, "month": 9, "month_year": "2025-09", "revenue": 37720.840000000004, "checks": 2290, "clients": 1213, "items": 4227.0, "yoy": 6.6}, {"year": 2025, "month": 10, "month_year": "2025-10", "revenue": 31355.34, "checks": 1713, "clients": 976, "items": 3431.0, "yoy": -5.6}, {"year": 2025, "month": 11, "month_year": "2025-11", "revenue": 38124.52, "checks": 1971, "clients": 1115, "items": 3945.0, "yoy": 4.2}, {"year": 2025, "month": 12, "month_year": "2025-12", "revenue": 28708.25, "checks": 1578, "clients": 921, "items": 3436.0, "yoy": 0.0}, {"year": 2026, "month": 1, "month_year": "2026-01", "revenue": 36621.87, "checks": 2035, "clients": 1258, "items": 4128.0, "yoy": 7.5}], "categories": [{"item_category": "Rental - 1 hour", "revenue": 427624.4, "count": 32559}, {"item_category": "Birthday Package", "revenue": 96727.86, "count": 1427}, {"item_category": "Pass", "revenue": 90466.3, "count": 2147}, {"item_category": "Food/Menu", "revenue": 81926.1, "count": 728}, {"item_category": "Rental - 30 min", "revenue": 70832.77, "count": 8569}, {"item_category": "Other", "revenue": 37587.090000000004, "count": 4162}, {"item_category": "Socks", "revenue": 28828.0, "count": 11872}, {"item_category": "Voucher/Bonus", "revenue": 27492.0, "count": 1018}, {"item_category": "Children Services", "revenue": 8448.2, "count": 1459}, {"item_category": "Rental - Other", "revenue": 1989.3, "count": 41}, {"item_category": "Lottery/Prize", "revenue": 402.0, "count": 276}, {"item_category": "Rental - 2 hours", "revenue": 80.19, "count": 2}, {"item_category": "Discount/Promotion", "revenue": 9.46, "count": 932}, {"item_category": "Gift Certificate", "revenue": 5.92, "count": 559}], "dow": [{"day_of_week": 0, "day_name": "Monday", "revenue": 81629.19, "checks": 4957}, {"day_of_week": 1, "day_name": "Tuesday", "revenue": 85634.04000000001, "checks": 5070}, {"day_of_week": 2, "day_name": "Wednesday", "revenue": 93054.8, "checks": 5469}, {"day_of_week": 3, "day_name": "Thursday", "revenue": 96177.35, "checks": 5516}, {"day_of_week": 4, "day_name": "Friday", "revenue": 115798.05, "checks": 6311}, {"day_of_week": 5, "day_name": "Saturday", "revenue": 213247.4, "checks": 11949}, {"day_of_week": 6, "day_name": "Sunday", "revenue": 186878.76, "checks": 11271}], "hourly": [{"hour": 10, "revenue": 20192.99, "checks": 1283}, {"hour": 11, "revenue": 50131.75, "checks": 2977}, {"hour": 12, "revenue": 51052.01, "checks": 3377}, {"hour": 13, "revenue": 38148.33, "checks": 2207}, {"hour": 14, "revenue": 30943.74, "checks": 1519}, {"hour": 15, "revenue": 43156.2, "checks": 2462}, {"hour": 16, "revenue": 87877.43000000001, "checks": 5385}, {"hour": 17, "revenue": 143957.01, "checks": 8704}, {"hour": 18, "revenue": 165565.67, "checks": 10162}, {"hour": 19, "revenue": 146519.47, "checks": 8040}, {"hour": 20, "revenue": 78828.83, "checks": 4084}, {"hour": 21, "revenue": 13503.36, "checks": 722}, {"hour": 22, "revenue": 2060.32, "checks": 40}, {"hour": 23, "revenue": 482.48, "checks": 9}], "segments": [{"segment": "Champion (30+)", "revenue": 22852.95, "clients": 22, "checks": 1425}, {"segment": "Loyal (15-29)", "revenue": 34694.85, "clients": 143, "checks": 2689}, {"segment": "New (1-2)", "revenue": 231810.83000000002, "clients": 10947, "checks": 12722}, {"segment": "Occasional (3-6)", "revenue": 154159.19, "clients": 2616, "checks": 9798}, {"segment": "Regular (7-14)", "revenue": 97790.83, "clients": 752, "checks": 6784}], "seg_monthly": [{"month_year": "2024-01", "year": 2024, "month": 1, "segment": "Champion (30+)", "revenue": 112.3, "clients": 3}, {"month_year": "2024-01", "year": 2024, "month": 1, "segment": "Loyal (15-29)", "revenue": 114.0, "clients": 7}, {"month_year": "2024-01", "year": 2024, "month": 1, "segment": "New (1-2)", "revenue": 2291.8, "clients": 167}, {"month_year": "2024-01", "year": 2024, "month": 1, "segment": "Occasional (3-6)", "revenue": 1738.4, "clients": 87}, {"month_year": "2024-01", "year": 2024, "month": 1, "segment": "Regular (7-14)", "revenue": 901.4, "clients": 45}, {"month_year": "2024-02", "year": 2024, "month": 2, "segment": "Champion (30+)", "revenue": 203.6, "clients": 11}, {"month_year": "2024-02", "year": 2024, "month": 2, "segment": "Loyal (15-29)", "revenue": 1453.1000000000001, "clients": 62}, {"month_year": "2024-02", "year": 2024, "month": 2, "segment": "New (1-2)", "revenue": 16057.7, "clients": 1001}, {"month_year": "2024-02", "year": 2024, "month": 2, "segment": "Occasional (3-6)", "revenue": 7896.7, "clients": 403}, {"month_year": "2024-02", "year": 2024, "month": 2, "segment": "Regular (7-14)", "revenue": 4114.2, "clients": 200}, {"month_year": "2024-03", "year": 2024, "month": 3, "segment": "Champion (30+)", "revenue": 495.7, "clients": 15}, {"month_year": "2024-03", "year": 2024, "month": 3, "segment": "Loyal (15-29)", "revenue": 1645.71, "clients": 62}, {"month_year": "2024-03", "year": 2024, "month": 3, "segment": "New (1-2)", "revenue": 16334.800000000001, "clients": 993}, {"month_year": "2024-03", "year": 2024, "month": 3, "segment": "Occasional (3-6)", "revenue": 10292.35, "clients": 496}, {"month_year": "2024-03", "year": 2024, "month": 3, "segment": "Regular (7-14)", "revenue": 5541.59, "clients": 245}, {"month_year": "2024-04", "year": 2024, "month": 4, "segment": "Champion (30+)", "revenue": 344.90000000000003, "clients": 12}, {"month_year": "2024-04", "year": 2024, "month": 4, "segment": "Loyal (15-29)", "revenue": 1481.2, "clients": 56}, {"month_year": "2024-04", "year": 2024, "month": 4, "segment": "New (1-2)", "revenue": 8353.17, "clients": 532}, {"month_year": "2024-04", "year": 2024, "month": 4, "segment": "Occasional (3-6)", "revenue": 6066.12, "clients": 350}, {"month_year": "2024-04", "year": 2024, "month": 4, "segment": "Regular (7-14)", "revenue": 3660.4100000000003, "clients": 206}, {"month_year": "2024-05", "year": 2024, "month": 5, "segment": "Champion (30+)", "revenue": 617.63, "clients": 9}, {"month_year": "2024-05", "year": 2024, "month": 5, "segment": "Loyal (15-29)", "revenue": 1734.14, "clients": 69}, {"month_year": "2024-05", "year": 2024, "month": 5, "segment": "New (1-2)", "revenue": 7845.42, "clients": 441}, {"month_year": "2024-05", "year": 2024, "month": 5, "segment": "Occasional (3-6)", "revenue": 6508.6900000000005, "clients": 346}, {"month_year": "2024-05", "year": 2024, "month": 5, "segment": "Regular (7-14)", "revenue": 3542.6400000000003, "clients": 194}, {"month_year": "2024-06", "year": 2024, "month": 6, "segment": "Champion (30+)", "revenue": 683.9, "clients": 15}, {"month_year": "2024-06", "year": 2024, "month": 6, "segment": "Loyal (15-29)", "revenue": 1773.3400000000001, "clients": 76}, {"month_year": "2024-06", "year": 2024, "month": 6, "segment": "New (1-2)", "revenue": 5547.03, "clients": 365}, {"month_year": "2024-06", "year": 2024, "month": 6, "segment": "Occasional (3-6)", "revenue": 5374.39, "clients": 326}, {"month_year": "2024-06", "year": 2024, "month": 6, "segment": "Regular (7-14)", "revenue": 4242.03, "clients": 211}, {"month_year": "2024-07", "year": 2024, "month": 7, "segment": "Champion (30+)", "revenue": 539.21, "clients": 17}, {"month_year": "2024-07", "year": 2024, "month": 7, "segment": "Loyal (15-29)", "revenue": 1296.78, "clients": 70}, {"month_year": "2024-07", "year": 2024, "month": 7, "segment": "New (1-2)", "revenue": 7461.24, "clients": 482}, {"month_year": "2024-07", "year": 2024, "month": 7, "segment": "Occasional (3-6)", "revenue": 5777.87, "clients": 337}, {"month_year": "2024-07", "year": 2024, "month": 7, "segment": "Regular (7-14)", "revenue": 4752.0, "clients": 227}, {"month_year": "2024-08", "year": 2024, "month": 8, "segment": "Champion (30+)", "revenue": 193.0, "clients": 11}, {"month_year": "2024-08", "year": 2024, "month": 8, "segment": "Loyal (15-29)", "revenue": 1468.25, "clients": 67}, {"month_year": "2024-08", "year": 2024, "month": 8, "segment": "New (1-2)", "revenue": 7836.900000000001, "clients": 477}, {"month_year": "2024-08", "year": 2024, "month": 8, "segment": "Occasional (3-6)", "revenue": 7095.84, "clients": 383}, {"month_year": "2024-08", "year": 2024, "month": 8, "segment": "Regular (7-14)", "revenue": 5275.25, "clients": 237}, {"month_year": "2024-09", "year": 2024, "month": 9, "segment": "Champion (30+)", "revenue": 369.52000000000004, "clients": 17}, {"month_year": "2024-09", "year": 2024, "month": 9, "segment": "Loyal (15-29)", "revenue": 1661.6200000000001, "clients": 74}, {"month_year": "2024-09", "year": 2024, "month": 9, "segment": "New (1-2)", "revenue": 5252.39, "clients": 346}, {"month_year": "2024-09", "year": 2024, "month": 9, "segment": "Occasional (3-6)", "revenue": 4912.2300000000005, "clients": 305}, {"month_year": "2024-09", "year": 2024, "month": 9, "segment": "Regular (7-14)", "revenue": 3219.4, "clients": 188}, {"month_year": "2024-10", "year": 2024, "month": 10, "segment": "Champion (30+)", "revenue": 580.13, "clients": 17}, {"month_year": "2024-10", "year": 2024, "month": 10, "segment": "Loyal (15-29)", "revenue": 1389.92, "clients": 67}, {"month_year": "2024-10", "year": 2024, "month": 10, "segment": "New (1-2)", "revenue": 5795.32, "clients": 357}, {"month_year": "2024-10", "year": 2024, "month": 10, "segment": "Occasional (3-6)", "revenue": 4751.37, "clients": 299}, {"month_year": "2024-10", "year": 2024, "month": 10, "segment": "Regular (7-14)", "revenue": 3398.27, "clients": 196}, {"month_year": "2024-11", "year": 2024, "month": 11, "segment": "Champion (30+)", "revenue": 361.71, "clients": 14}, {"month_year": "2024-11", "year": 2024, "month": 11, "segment": "Loyal (15-29)", "revenue": 1412.6200000000001, "clients": 68}, {"month_year": "2024-11", "year": 2024, "month": 11, "segment": "New (1-2)", "revenue": 6024.18, "clients": 328}, {"month_year": "2024-11", "year": 2024, "month": 11, "segment": "Occasional (3-6)", "revenue": 4605.29, "clients": 267}, {"month_year": "2024-11", "year": 2024, "month": 11, "segment": "Regular (7-14)", "revenue": 3484.4700000000003, "clients": 188}, {"month_year": "2024-12", "year": 2024, "month": 12, "segment": "Champion (30+)", "revenue": 443.82, "clients": 17}, {"month_year": "2024-12", "year": 2024, "month": 12, "segment": "Loyal (15-29)", "revenue": 1408.42, "clients": 59}, {"month_year": "2024-12", "year": 2024, "month": 12, "segment": "New (1-2)", "revenue": 5606.2300000000005, "clients": 307}, {"month_year": "2024-12", "year": 2024, "month": 12, "segment": "Occasional (3-6)", "revenue": 4524.04, "clients": 228}, {"month_year": "2024-12", "year": 2024, "month": 12, "segment": "Regular (7-14)", "revenue": 3251.2400000000002, "clients": 166}, {"month_year": "2025-01", "year": 2025, "month": 1, "segment": "Champion (30+)", "revenue": 457.92, "clients": 19}, {"month_year": "2025-01", "year": 2025, "month": 1, "segment": "Loyal (15-29)", "revenue": 2043.5900000000001, "clients": 79}, {"month_year": "2025-01", "year": 2025, "month": 1, "segment": "New (1-2)", "revenue": 6476.61, "clients": 362}, {"month_year": "2025-01", "year": 2025, "month": 1, "segment": "Occasional (3-6)", "revenue": 5265.9400000000005, "clients": 288}, {"month_year": "2025-01", "year": 2025, "month": 1, "segment": "Regular (7-14)", "revenue": 4079.08, "clients": 216}, {"month_year": "2025-02", "year": 2025, "month": 2, "segment": "Champion (30+)", "revenue": 533.53, "clients": 20}, {"month_year": "2025-02", "year": 2025, "month": 2, "segment": "Loyal (15-29)", "revenue": 1824.24, "clients": 80}, {"month_year": "2025-02", "year": 2025, "month": 2, "segment": "New (1-2)", "revenue": 10393.77, "clients": 574}, {"month_year": "2025-02", "year": 2025, "month": 2, "segment": "Occasional (3-6)", "revenue": 6755.17, "clients": 385}, {"month_year": "2025-02", "year": 2025, "month": 2, "segment": "Regular (7-14)", "revenue": 3945.87, "clients": 245}, {"month_year": "2025-03", "year": 2025, "month": 3, "segment": "Champion (30+)", "revenue": 457.12, "clients": 16}, {"month_year": "2025-03", "year": 2025, "month": 3, "segment": "Loyal (15-29)", "revenue": 1759.32, "clients": 75}, {"month_year": "2025-03", "year": 2025, "month": 3, "segment": "New (1-2)", "revenue": 11789.14, "clients": 640}, {"month_year": "2025-03", "year": 2025, "month": 3, "segment": "Occasional (3-6)", "revenue": 6985.2, "clients": 382}, {"month_year": "2025-03", "year": 2025, "month": 3, "segment": "Regular (7-14)", "revenue": 4410.26, "clients": 221}, {"month_year": "2025-04", "year": 2025, "month": 4, "segment": "Champion (30+)", "revenue": 260.22, "clients": 12}, {"month_year": "2025-04", "year": 2025, "month": 4, "segment": "Loyal (15-29)", "revenue": 1410.91, "clients": 59}, {"month_year": "2025-04", "year": 2025, "month": 4, "segment": "New (1-2)", "revenue": 8992.84, "clients": 529}, {"month_year": "2025-04", "year": 2025, "month": 4, "segment": "Occasional (3-6)", "revenue": 5543.85, "clients": 305}, {"month_year": "2025-04", "year": 2025, "month": 4, "segment": "Regular (7-14)", "revenue": 3593.4700000000003, "clients": 201}, {"month_year": "2025-05", "year": 2025, "month": 5, "segment": "Champion (30+)", "revenue": 393.8, "clients": 16}, {"month_year": "2025-05", "year": 2025, "month": 5, "segment": "Loyal (15-29)", "revenue": 1564.3, "clients": 62}, {"month_year": "2025-05", "year": 2025, "month": 5, "segment": "New (1-2)", "revenue": 6834.62, "clients": 400}, {"month_year": "2025-05", "year": 2025, "month": 5, "segment": "Occasional (3-6)", "revenue": 5000.650000000001, "clients": 279}, {"month_year": "2025-05", "year": 2025, "month": 5, "segment": "Regular (7-14)", "revenue": 3493.44, "clients": 190}, {"month_year": "2025-06", "year": 2025, "month": 6, "segment": "Champion (30+)", "revenue": 269.42, "clients": 12}, {"month_year": "2025-06", "year": 2025, "month": 6, "segment": "Loyal (15-29)", "revenue": 1027.23, "clients": 55}, {"month_year": "2025-06", "year": 2025, "month": 6, "segment": "New (1-2)", "revenue": 5262.89, "clients": 311}, {"month_year": "2025-06", "year": 2025, "month": 6, "segment": "Occasional (3-6)", "revenue": 4186.62, "clients": 231}, {"month_year": "2025-06", "year": 2025, "month": 6, "segment": "Regular (7-14)", "revenue": 2643.11, "clients": 137}, {"month_year": "2025-07", "year": 2025, "month": 7, "segment": "Champion (30+)", "revenue": 365.62, "clients": 11}, {"month_year": "2025-07", "year": 2025, "month": 7, "segment": "Loyal (15-29)", "revenue": 1409.48, "clients": 63}, {"month_year": "2025-07", "year": 2025, "month": 7, "segment": "New (1-2)", "revenue": 11088.380000000001, "clients": 554}, {"month_year": "2025-07", "year": 2025, "month": 7, "segment": "Occasional (3-6)", "revenue": 5844.59, "clients": 302}, {"month_year": "2025-07", "year": 2025, "month": 7, "segment": "Regular (7-14)", "revenue": 3959.4, "clients": 192}, {"month_year": "2025-08", "year": 2025, "month": 8, "segment": "Champion (30+)", "revenue": 438.52000000000004, "clients": 16}, {"month_year": "2025-08", "year": 2025, "month": 8, "segment": "Loyal (15-29)", "revenue": 1198.6200000000001, "clients": 66}, {"month_year": "2025-08", "year": 2025, "month": 8, "segment": "New (1-2)", "revenue": 17381.0, "clients": 898}, {"month_year": "2025-08", "year": 2025, "month": 8, "segment": "Occasional (3-6)", "revenue": 9895.65, "clients": 498}, {"month_year": "2025-08", "year": 2025, "month": 8, "segment": "Regular (7-14)", "revenue": 5766.27, "clients": 257}, {"month_year": "2025-09", "year": 2025, "month": 9, "segment": "Champion (30+)", "revenue": 207.4, "clients": 12}, {"month_year": "2025-09", "year": 2025, "month": 9, "segment": "Loyal (15-29)", "revenue": 1297.9, "clients": 61}, {"month_year": "2025-09", "year": 2025, "month": 9, "segment": "New (1-2)", "revenue": 10107.15, "clients": 557}, {"month_year": "2025-09", "year": 2025, "month": 9, "segment": "Occasional (3-6)", "revenue": 7677.32, "clients": 379}, {"month_year": "2025-09", "year": 2025, "month": 9, "segment": "Regular (7-14)", "revenue": 4146.6900000000005, "clients": 203}, {"month_year": "2025-10", "year": 2025, "month": 10, "segment": "Champion (30+)", "revenue": 13337.54, "clients": 17}, {"month_year": "2025-10", "year": 2025, "month": 10, "segment": "Loyal (15-29)", "revenue": 849.7, "clients": 50}, {"month_year": "2025-10", "year": 2025, "month": 10, "segment": "New (1-2)", "revenue": 9104.91, "clients": 480}, {"month_year": "2025-10", "year": 2025, "month": 10, "segment": "Occasional (3-6)", "revenue": 4948.4800000000005, "clients": 274}, {"month_year": "2025-10", "year": 2025, "month": 10, "segment": "Regular (7-14)", "revenue": 3114.71, "clients": 155}, {"month_year": "2025-11", "year": 2025, "month": 11, "segment": "Champion (30+)", "revenue": 375.09999999999997, "clients": 16}, {"month_year": "2025-11", "year": 2025, "month": 11, "segment": "Loyal (15-29)", "revenue": 1109.1, "clients": 58}, {"month_year": "2025-11", "year": 2025, "month": 11, "segment": "New (1-2)", "revenue": 9869.13, "clients": 514}, {"month_year": "2025-11", "year": 2025, "month": 11, "segment": "Occasional (3-6)", "revenue": 7477.17, "clients": 334}, {"month_year": "2025-11", "year": 2025, "month": 11, "segment": "Regular (7-14)", "revenue": 4173.13, "clients": 192}, {"month_year": "2025-12", "year": 2025, "month": 12, "segment": "Champion (30+)", "revenue": 348.44, "clients": 12}, {"month_year": "2025-12", "year": 2025, "month": 12, "segment": "Loyal (15-29)", "revenue": 918.3100000000001, "clients": 47}, {"month_year": "2025-12", "year": 2025, "month": 12, "segment": "New (1-2)", "revenue": 12064.44, "clients": 424}, {"month_year": "2025-12", "year": 2025, "month": 12, "segment": "Occasional (3-6)", "revenue": 5047.04, "clients": 264}, {"month_year": "2025-12", "year": 2025, "month": 12, "segment": "Regular (7-14)", "revenue": 4379.07, "clients": 173}, {"month_year": "2026-01", "year": 2026, "month": 1, "segment": "Champion (30+)", "revenue": 462.9, "clients": 13}, {"month_year": "2026-01", "year": 2026, "month": 1, "segment": "Loyal (15-29)", "revenue": 1443.05, "clients": 56}, {"month_year": "2026-01", "year": 2026, "month": 1, "segment": "New (1-2)", "revenue": 18039.77, "clients": 661}, {"month_year": "2026-01", "year": 2026, "month": 1, "segment": "Occasional (3-6)", "revenue": 9988.22, "clients": 342}, {"month_year": "2026-01", "year": 2026, "month": 1, "segment": "Regular (7-14)", "revenue": 4703.43, "clients": 185}], "weekend": [{"label": "Weekday", "revenue": 472293.43, "checks": 25194}, {"label": "Weekend", "revenue": 400126.16000000003, "checks": 21979}], "season": [{"season": "Fall", "revenue": 212386.85}, {"season": "Spring", "revenue": 210024.12}, {"season": "Summer", "revenue": 207960.64}, {"season": "Winter", "revenue": 242047.98}], "tod": [{"time_of_day": "Afternoon (12-15)", "revenue": 120010.69, "checks": 6584}, {"time_of_day": "Evening (18-21)", "revenue": 244009.37, "checks": 12916}, {"time_of_day": "Late Afternoon (15-18)", "revenue": 385745.35000000003, "checks": 21815}, {"time_of_day": "Morning (9-12)", "revenue": 120111.38, "checks": 7380}, {"time_of_day": "Night (21-24)", "revenue": 2542.8, "checks": 49}], "top_items": [{"item_name": "Alquiler Limon Loco 1 hora fin de SEMANA", "revenue": 289636.0, "qty": 30363.0}, {"item_name": "Alquiler Limon Loco 1 hora entre SEMANA", "revenue": 137988.4, "qty": 16166.0}, {"item_name": "Pase Limon Loco 6 horas", "revenue": 80837.4, "qty": 2026.0}, {"item_name": "Alquiler Limon Loco 30 min. fin de SEMANA", "revenue": 47180.8, "qty": 7399.0}, {"item_name": "Promesa de Cumplea\u00f1os Limon Loco", "revenue": 39150.0, "qty": 783.0}, {"item_name": "D\u00eda de Fiesta de cumplea\u00f1os (10 personas) sin comida", "revenue": 32035.0, "qty": 215.0}, {"item_name": "Alquiler Limon Loco 30 min. entre SEMANA", "revenue": 23651.9, "qty": 4400.0}, {"item_name": "Suplemento por cumplea\u00f1os de lunes a Viernes (10 personas) sin comida", "revenue": 21420.0, "qty": 180.0}, {"item_name": "eliminado BONO Black Friday -50% - 19,90e 6 H (LL1 LL2)", "revenue": 13074.3, "qty": 657.0}, {"item_name": "Cumplea\u00f1os 2 horas con 1 persona de SALIDA sin comida", "revenue": 11860.4, "qty": 596.0}]};

const fmt = n => n==null?'—':'€'+n.toLocaleString('es-ES',{minimumFractionDigits:0,maximumFractionDigits:0});
const fmtK = n => n>=1000?'€'+(n/1000).toFixed(1)+'k':'€'+n.toFixed(0);
const fmtN = n => n==null?'—':n.toLocaleString('es-ES');

// Chart.js defaults
Chart.defaults.font.family = "-apple-system,BlinkMacSystemFont,'SF Pro Display','Segoe UI',Roboto,sans-serif";
Chart.defaults.font.size = 11;
Chart.defaults.color = '#636e72';
Chart.defaults.plugins.legend.labels.usePointStyle = true;
Chart.defaults.plugins.legend.labels.padding = 16;
Chart.defaults.elements.bar.borderRadius = 6;
Chart.defaults.elements.line.tension = 0.35;
Chart.defaults.elements.point.radius = 2;
Chart.defaults.elements.point.hoverRadius = 5;
Chart.defaults.scale.grid = { color: 'rgba(163,177,198,0.15)' };

const P = {
  accent: '#6c5ce7', accent2: '#00cec9', accent3: '#0984e3',
  purple: '#a29bfe', teal: '#81ecec', blue: '#74b9ff',
  pink: '#fd79a8', orange: '#fab1a0', green: '#55efc4',
  yellow: '#ffeaa7', red: '#ff7675', gray: '#b2bec3'
};
const segColors = {
  'New (1-2)': P.gray, 'Occasional (3-6)': P.blue,
  'Regular (7-14)': P.accent2, 'Loyal (15-29)': P.accent,
  'Champion (30+)': P.pink
};
const segOrder = ['New (1-2)','Occasional (3-6)','Regular (7-14)','Loyal (15-29)','Champion (30+)'];

let charts = {};
let currentYear = 'all';

// Year filter buttons
function buildFilters() {
  const c = document.getElementById('yearFilters');
  ['all','2024','2025','2026'].forEach(y => {
    const b = document.createElement('button');
    b.className = 'filter-btn' + (y==='all'?' active':'');
    b.textContent = y==='all'?'All Years':y;
    b.dataset.year = y;
    b.onclick = () => {
      document.querySelectorAll('.filter-btn').forEach(x=>x.classList.remove('active'));
      b.classList.add('active');
      currentYear = y;
      render();
    };
    c.appendChild(b);
  });
}

function getMonthly() {
  return currentYear==='all' ? D.monthly : D.monthly.filter(r=>r.year===parseInt(currentYear));
}

function renderKPIs() {
  const m = getMonthly();
  const rev = m.reduce((s,r)=>s+r.revenue,0);
  const checks = m.reduce((s,r)=>s+r.checks,0);
  const clients = m.reduce((s,r)=>s+r.clients,0);
  const items = m.reduce((s,r)=>s+r.items,0);
  const avgCheck = checks>0?rev/checks:0;

  let yoyHtml = '<div class="sub neutral">All periods</div>';
  if (currentYear==='2025') {
    const g = D.kpis.yoy_growth;
    yoyHtml = `<div class="sub ${g>=0?'up':'down'}">${g>=0?'↑':'↓'} ${Math.abs(g)}% vs 2024</div>`;
  }

  document.getElementById('kpiRow').innerHTML = `
    <div class="card kpi"><div class="label">Revenue</div><div class="value">${fmt(Math.round(rev))}</div>${yoyHtml}</div>
    <div class="card kpi"><div class="label">Checks</div><div class="value">${fmtN(checks)}</div><div class="sub neutral">${m.length} months</div></div>
    <div class="card kpi"><div class="label">Avg Check</div><div class="value">${fmt(Math.round(avgCheck*100)/100)}</div><div class="sub neutral">per transaction</div></div>
    <div class="card kpi"><div class="label">Clients</div><div class="value">${fmtN(D.kpis.registered_clients)}</div><div class="sub neutral">registered</div></div>
    <div class="card kpi"><div class="label">Items Sold</div><div class="value">${fmtN(Math.round(items))}</div><div class="sub neutral">${D.kpis.retail_pct}% retail</div></div>
  `;
}

function buildRevChart() {
  const ctx = document.getElementById('revChart');
  if(charts.rev) charts.rev.destroy();
  const m = getMonthly();
  charts.rev = new Chart(ctx, {
    type:'bar',
    data:{
      labels: m.map(r=>r.month_year),
      datasets:[
        {label:'Revenue',data:m.map(r=>Math.round(r.revenue)),backgroundColor:'rgba(108,92,231,0.6)',hoverBackgroundColor:'#6c5ce7',yAxisID:'y',order:2},
        {label:'Checks',data:m.map(r=>r.checks),type:'line',borderColor:P.accent2,backgroundColor:'transparent',borderWidth:2.5,pointBackgroundColor:P.accent2,yAxisID:'y1',order:1}
      ]
    },
    options:{
      responsive:true, maintainAspectRatio:false,
      interaction:{intersect:false,mode:'index'},
      plugins:{legend:{position:'top'}},
      scales:{
        y:{position:'left',ticks:{callback:v=>fmtK(v)},grid:{color:'rgba(163,177,198,0.12)'}},
        y1:{position:'right',grid:{drawOnChartArea:false}},
        x:{ticks:{maxRotation:45,font:{size:10}},grid:{display:false}}
      }
    }
  });
}

function buildCatChart() {
  const ctx = document.getElementById('catChart');
  if(charts.cat) charts.cat.destroy();
  const top7 = D.categories.slice(0,7);
  const cols = [P.accent,P.accent2,P.accent3,P.purple,P.teal,P.pink,P.orange];
  charts.cat = new Chart(ctx, {
    type:'bar',
    data:{
      labels:top7.map(r=>r.item_category),
      datasets:[{data:top7.map(r=>Math.round(r.revenue)),backgroundColor:cols.map(c=>c+'cc'),borderColor:cols,borderWidth:1}]
    },
    options:{
      responsive:true,maintainAspectRatio:false,indexAxis:'y',
      plugins:{legend:{display:false},tooltip:{callbacks:{label:c=>fmt(c.raw)}}},
      scales:{x:{ticks:{callback:v=>fmtK(v)},grid:{color:'rgba(163,177,198,0.12)'}},y:{grid:{display:false}}}
    }
  });
}

function buildSegChart() {
  const ctx = document.getElementById('segChart');
  if(charts.seg) charts.seg.destroy();
  const ordered = segOrder.map(s=>D.segments.find(r=>r.segment===s)||{segment:s,revenue:0,clients:0,checks:0});
  charts.seg = new Chart(ctx, {
    type:'doughnut',
    data:{
      labels:ordered.map(r=>r.segment),
      datasets:[{data:ordered.map(r=>Math.round(r.revenue)),backgroundColor:segOrder.map(s=>segColors[s]),borderColor:'var(--bg)',borderWidth:3}]
    },
    options:{
      responsive:true,maintainAspectRatio:false,cutout:'62%',
      plugins:{
        legend:{position:'right',labels:{padding:10,font:{size:11}}},
        tooltip:{callbacks:{label:c=>{const d=ordered[c.dataIndex];return c.label+': '+fmt(c.raw)+' ('+fmtN(d.clients)+' clients)';}}}
      }
    }
  });
}

function buildDowChart() {
  const ctx = document.getElementById('dowChart');
  if(charts.dow) charts.dow.destroy();
  const colors = D.dow.map(r=>r.day_of_week>=5?P.accent:'rgba(108,92,231,0.35)');
  charts.dow = new Chart(ctx, {
    type:'bar',
    data:{
      labels:D.dow.map(r=>r.day_name.substring(0,3)),
      datasets:[{data:D.dow.map(r=>Math.round(r.revenue)),backgroundColor:colors}]
    },
    options:{
      responsive:true,maintainAspectRatio:false,
      plugins:{legend:{display:false},tooltip:{callbacks:{label:c=>fmt(c.raw)}}},
      scales:{y:{ticks:{callback:v=>fmtK(v)},grid:{color:'rgba(163,177,198,0.12)'}},x:{grid:{display:false}}}
    }
  });
}

function buildHourChart() {
  const ctx = document.getElementById('hourChart');
  if(charts.hour) charts.hour.destroy();
  charts.hour = new Chart(ctx, {
    type:'line',
    data:{
      labels:D.hourly.map(r=>r.hour+':00'),
      datasets:[{
        label:'Revenue',data:D.hourly.map(r=>Math.round(r.revenue)),
        borderColor:P.accent,backgroundColor:'rgba(108,92,231,0.08)',fill:true,borderWidth:2.5,
        pointBackgroundColor:P.accent
      }]
    },
    options:{
      responsive:true,maintainAspectRatio:false,
      plugins:{legend:{display:false},tooltip:{callbacks:{label:c=>fmt(c.raw)}}},
      scales:{y:{ticks:{callback:v=>fmtK(v)},grid:{color:'rgba(163,177,198,0.12)'}},x:{grid:{display:false}}}
    }
  });
}

function buildWkdChart() {
  const ctx = document.getElementById('wkdChart');
  if(charts.wkd) charts.wkd.destroy();
  charts.wkd = new Chart(ctx, {
    type:'doughnut',
    data:{
      labels:D.weekend.map(r=>r.label),
      datasets:[{data:D.weekend.map(r=>Math.round(r.revenue)),backgroundColor:[P.accent3,P.accent],borderColor:'var(--bg)',borderWidth:3}]
    },
    options:{
      responsive:true,maintainAspectRatio:false,cutout:'62%',
      plugins:{
        legend:{position:'bottom',labels:{padding:14}},
        tooltip:{callbacks:{label:c=>c.label+': '+fmt(c.raw)+' ('+fmtN(D.weekend[c.dataIndex].checks)+' checks)'}}
      }
    }
  });
}

function buildItemsTable() {
  const tbody = document.querySelector('#itemsTable tbody');
  tbody.innerHTML = D.top_items.map(r=>{
    const name = r.item_name.length>45?r.item_name.substring(0,42)+'...':r.item_name;
    return `<tr><td title="${r.item_name}">${name}</td><td class="text-right">${fmt(Math.round(r.revenue))}</td><td class="text-right">${fmtN(Math.round(r.qty))}</td></tr>`;
  }).join('');
}

function buildMonthTable() {
  const tbody = document.querySelector('#monthTable tbody');
  const m = getMonthly();
  tbody.innerHTML = m.map(r=>{
    const yc = r.yoy==null?'':r.yoy>=0?'yoy-pos':'yoy-neg';
    const ys = r.yoy==null?'—':(r.yoy>=0?'+':'')+r.yoy+'%';
    return `<tr><td>${r.month_year}</td><td class="text-right">${fmt(Math.round(r.revenue))}</td><td class="text-right">${fmtN(r.checks)}</td><td class="text-right ${yc}">${ys}</td></tr>`;
  }).join('');
}

function render() {
  renderKPIs();
  buildRevChart();
  buildCatChart();
  buildSegChart();
  buildDowChart();
  buildHourChart();
  buildWkdChart();
  buildItemsTable();
  buildMonthTable();
}

buildFilters();
render();
</script>
</body>
</html>